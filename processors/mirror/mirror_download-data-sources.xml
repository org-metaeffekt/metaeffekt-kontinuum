<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">

    <modelVersion>4.0.0</modelVersion>

    <!--
        Copyright 2024-2025 the original author or authors.

        Licensed under the Apache License, Version 2.0 (the "License");
        you may not use this file except in compliance with the License.
        You may obtain a copy of the License at

            http://www.apache.org/licenses/LICENSE-2.0

        Unless required by applicable law or agreed to in writing, software
        distributed under the License is distributed on an "AS IS" BASIS,
        WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
        See the License for the specific language governing permissions and
        limitations under the License.
        -->

    <parent>
        <groupId>com.metaeffekt.kontinuum</groupId>
        <artifactId>ae-kontinuum-processors</artifactId>
        <version>KONTINUUM-SNAPSHOT</version>
        <relativePath>../_common_/ae-kontinuum-processors.xml</relativePath>
    </parent>

    <artifactId>mirror_donwload-data-sources</artifactId>

    <!--FIXME: review how proxy can be configured best; check also resolver approach -->
    <properties>
        <param.proxy.scheme>none</param.proxy.scheme>
        <param.proxy.host>none</param.proxy.host>
        <param.proxy.port>-1</param.proxy.port>
        <param.proxy.user>none</param.proxy.user>
        <param.proxy.pass>none</param.proxy.pass>
    </properties>

    <build>
        <plugins>
            <plugin>
                <groupId>com.metaeffekt.artifact.analysis</groupId>
                <artifactId>ae-mirror-plugin</artifactId>
                <version>${ae.artifact.analysis.version}</version>
                <executions>
                    <execution>
                        <id>data-mirror</id>
                        <goals>
                            <goal>data-mirror</goal>
                        </goals>

                        <configuration>
                            <mirrorDirectory>${env.mirror.dir}</mirrorDirectory>

                            <proxyScheme>${param.proxy.scheme}</proxyScheme>
                            <proxyHost>${param.proxy.host}</proxyHost>
                            <proxyUsername>${param.proxy.user}</proxyUsername>
                            <proxyPassword>${param.proxy.pass}</proxyPassword>
                            <proxyPort>${param.proxy.port}</proxyPort>

                            <!-- here we fail on error at the end -->
                            <failOnDownloadError>true</failOnDownloadError>

                            <!-- Downloads -->


                            <!-- NOTE: the configuration has parts which are commented out. This is based on the following:
                                    - documentation is provided directly on the downloader configuration
                                    - the defaults are visible while still being explicit
                                    - the defaults may change and have an immediate effect without requiring
                                      an immediate adjustment on the configuration.
                                    - the configuration can be regularly synchronized with the reference
                                      configuration on https://github.com/org-metaeffekt/metaeffekt-documentation-template/blob/main/mirror/pom.xml

                                 A regular review of the CSAF-Listers and OSV sources is also recommended.
                            -->

                            <certSeiDownload>
                                <resourceLocations>
                                    <!-- Summary URL for a given year.
                                         - %s Summary year (example: 2020) -->
                                    <!--<SUMMARY_API_URL>https://kb.cert.org/vuls/api/%d/summary/</SUMMARY_API_URL>-->

                                    <!-- URL for a certain note.
                                         - %s Note Identifier (example: 257161) -->
                                    <!--<NOTES_API_URL>https://kb.cert.org/vuls/api/%s/</NOTES_API_URL>-->
                                </resourceLocations>
                            </certSeiDownload>

                            <certFrDownload>
                                <resourceLocations>
                                    <!-- Yearly archive download URL.
                                         - %d Archive year (example: 2020) -->
                                    <!--<CERT_FR_ARCHIVE>https://metaeffekt.com/mirror/cert-fr/json/%d.tar</CERT_FR_ARCHIVE>-->

                                    <!-- RSS feed that contains the latest changes to the mirror. Used to check if update is required. -->
                                    <!--<CERT_FR_RSS_FEED>https://www.cert.ssi.gouv.fr/feed/</CERT_FR_RSS_FEED>-->
                                </resourceLocations>
                            </certFrDownload>

                            <certEuDownload>
                                <resourceLocations>
                                    <!-- HTML page containing a list of all CERT-EU entries published in a single year.
                                         - %d Year (example: 2020) -->
                                    <!--<YEARLY_PUBLICATIONS_URL>https://cert.europa.eu/publications/security-advisories/%d</YEARLY_PUBLICATIONS_URL>-->

                                    <!-- JSON file containing the details of a single CERT-EU entry.
                                         - %s Entry ID (example: 2024-042) -->
                                    <!--<SINGLE_ENTRY_URL>https://cert.europa.eu/publications/security-advisories/%s/json</SINGLE_ENTRY_URL>-->

                                    <!-- RSS feed for the latest updated/ created CERT-EU entries. Used to check if update is required. -->
                                    <!--<RSS_FEED>https://cert.europa.eu/publications/security-advisories-rss</RSS_FEED>-->
                                </resourceLocations>
                            </certEuDownload>

                            <nvdCveDownload>
                                <!-- you will need an API key in order to download the NVD data:
                                     https://nvd.nist.gov/developers/request-an-api-key
                                     more information: https://nvd.nist.gov/developers/start-here -->
                                <apiKey>${env.nvd.apikey}</apiKey>

                                <resourceLocations>
                                    <!-- - %d startIndex: 0-based index of the first CVE to be returned in the response data -->
                                    <!--<CVE_API_LIST_ALL>https://services.nvd.nist.gov/rest/json/cves/2.0?startIndex=%d</CVE_API_LIST_ALL> -->

                                    <!-- The maximum allowable range when using any date range parameters is 120 consecutive days.
                                         Values must be entered in the extended ISO-8061 date/time format: [YYYY][“-”][MM][“-”][DD][“T”][HH][“:”][MM][“:”][SS][Z]
                                         - %d startIndex: 0-based index of the first CVE to be returned in the response data
                                         - %s lastModStartDate: the start date
                                         - %s lastModEndDate: the end date
                                    -->
                                    <!--<CVE_API_START_END_DATE>https://services.nvd.nist.gov/rest/json/cves/2.0/?startIndex=%d&amp;lastModStartDate=%s&amp;lastModEndDate=%s</CVE_API_START_END_DATE>-->
                                </resourceLocations>
                            </nvdCveDownload>

                            <nvdCpeDownload>
                                <!-- you will need an API key in order to download the NVD data:
                                     https://nvd.nist.gov/developers/request-an-api-key
                                     more information: https://nvd.nist.gov/developers/start-here -->
                                <apiKey>${env.nvd.apikey}</apiKey>

                                <resourceLocations>
                                    <!-- API URL for the NVD CPE API (cpes) with a start index parameter.
                                         - %d startIndex 0-based index of the first CPE to be returned in the response data -->
                                    <!--<CPE_API_LIST_ALL>https://services.nvd.nist.gov/rest/json/cpes/2.0?startIndex=%d</CPE_API_LIST_ALL>-->

                                    <!-- API URL for the NVD CPE API (cpes) with a start index and start/end timestamp parameter.
                                         The maximum allowable range when using any date range parameters is 120 consecutive days.
                                         Values must be entered in the extended ISO-8061 date/time format:
                                         [YYYY][“-”][MM][“-”][DD][“T”][HH][“:”][MM][“:”][SS][Z]
                                         - %d startIndex 0-based index of the first CPE to be returned in the response data
                                         - %s lastModStartDate the start date
                                         - %s lastModEndDate the end date
                                    -->
                                    <!--<CPE_API_START_END_DATE>https://services.nvd.nist.gov/rest/json/cpes/2.0?startIndex=%d&amp;lastModStartDate=%s&amp;lastModEndDate=%s</CPE_API_START_END_DATE> -->

                                    <!-- API URL for the NVD CPE API (cpematch) with a start index parameter.
                                         - startIndex 0-based index of the first CPE to be returned in the response data -->
                                    <!--<CPE_MATCH_API_LIST_ALL>https://services.nvd.nist.gov/rest/json/cpematch/2.0?startIndex=%d</CPE_MATCH_API_LIST_ALL>-->

                                    <!-- API URL for the NVD CPE API (cpematch) with a start index and start/end timestamp parameter.
                                         The maximum allowable range when using any date range parameters is 120 consecutive days.
                                         Values must be entered in the extended ISO-8061 date/time format:
                                         [YYYY][“-”][MM][“-”][DD][“T”][HH][“:”][MM][“:”][SS][Z]
                                         - %d startIndex 0-based index of the first CPE to be returned in the response data
                                         - %s lastModStartDate the start date
                                         - %s lastModEndDate the end date
                                    -->
                                    <!--<CPE_MATCH_API_START_END_DATE>https://services.nvd.nist.gov/rest/json/cpematch/2.0?startIndex=%d&amp;lastModStartDate=%s&amp;lastModEndDate=%s</CPE_MATCH_API_START_END_DATE>-->
                                </resourceLocations>
                            </nvdCpeDownload>

                            <msrcDownload>
                                <resourceLocations>
                                    <!-- List of all monthly documents. Contains last update date used to determine whether an update is required.
                                         When viewed in a browser, the content will be displayed as XML, but when accessed via the API, the content
                                         will be returned as JSON. -->

                                    <!--<MSRC_UPDATES_URL>https://api.msrc.microsoft.com/cvrf/v2.0/updates</MSRC_UPDATES_URL>-->
                                    <!-- REST-API for the Microsoft Security Response Center (MSRC) Common Vulnerability Reporting Framework (CVRF) v2.0.
                                         https://api.msrc.microsoft.com/cvrf/v2.0/swagger/index
                                         - %s CVRF document ID (yyyy-mmm) (example: 2021-dec)
                                     -->
                                    <!--<MSRC_CVRF_BASE_URL>https://api.msrc.microsoft.com/cvrf/v2.0/cvrf/%s</MSRC_CVRF_BASE_URL>-->
                                </resourceLocations>
                            </msrcDownload>

                            <msrcSecurityUpdateGuideDownload>
                                <resourceLocations>
                                    <!-- Endpoint that the https://msrc.microsoft.com/update-guide/ uses to construct the xlsx and csv files locally.
                                         Has parameters that are filled by the code, which are not supplied here. -->
                                    <!--<AFFECTED_PRODUCTS_BASE_URL>https://api.msrc.microsoft.com/sug/v2.0/en-US/affectedProduct</AFFECTED_PRODUCTS_BASE_URL>-->
                                </resourceLocations>
                            </msrcSecurityUpdateGuideDownload>

                            <githubAdvisorDownload>
                                <useGitCommand>true</useGitCommand>
                                <resourceLocations>
                                    <!-- Remote repository URL of the github/advisory-database repository -->
                                    <!--<GHSA_GIT_URL>https://github.com/github/advisory-database</GHSA_GIT_URL>-->

                                    <!-- Remote URL of the zip download of the github/advisory-database repository -->
                                    <!--<GHSA_GIT_ZIP_DOWNLOAD_URL>https://github.com/github/advisory-database/archive/refs/heads/main.zip</GHSA_GIT_ZIP_DOWNLOAD_URL>-->
                                </resourceLocations>
                            </githubAdvisorDownload>

                            <osvAdvisorDownload>
                                <resourceLocations>
                                    <!-- URL to fetch the list of ecosystems available for download.<br>
                                        Response contains one entry per line. -->
                                    <!--<ECOSYSTEMS_URL>https://osv-vulnerabilities.storage.googleapis.com/ecosystems.txt</ECOSYSTEMS_URL>-->

                                    <!-- URL to fetch metadata of a specific file, like name, generationId, updated, etc.
                                    Ecosystem name (example: npm)
                                    - %s Wanted File (example: zip.all)-->

                                    <!--<INDIVIDUAL_FILE_METADATA>https://www.googleapis.com/storage/v1/b/osv-vulnerabilities/o/%s%%2F%s</INDIVIDUAL_FILE_METADATA>-->
                                    <!-- URL to download the specified file from the specific location with ecosystem, name, and generationId.
                                    - %s Ecosystem name (example: npm)
                                    - %s Wanted File (example: zip.all)
                                    - %s GenerationId (example: 1725867421795347) -->

                                    <!--<DOWNLOAD_FILE>https://www.googleapis.com/download/storage/v1/b/osv-vulnerabilities/o/%s%%2F%s?generation=%s&amp;alt=media</DOWNLOAD_FILE>-->
                                </resourceLocations>
                            </osvAdvisorDownload>

                            <csafDownload>
                                <!-- overwrite default listers to query for providers -->
                                <!--<listerList>
                                    <lister>
                                        <name>BSI</name>
                                        <url>https://wid.cert-bund.de/.well-known/csaf-aggregator/aggregator.json</url>
                                    </lister>
                                </listerList>-->

                                <!-- filter providers fetched using the listers -->
                                <!-- FIXME: revise naming here excludes/exclude, includes/include -->
                                <excludeList>
                                    <exclude>
                                        <!-- reason for exclusion: requires additional authentication -->
                                        <name>huawei_psirt</name>
                                        <url>https://www.huawei.com/.well-known/csaf/provider-metadata.json</url>
                                    </exclude>
                                </excludeList>
                                <!--<includeList></includeList>-->
                            </csafDownload>

                            <cisaKevDownload>
                                <resourceLocations>
                                    <!-- URL for the KEV API that is used to fetch all known KEVs known to CISA. -->
                                    <!--<CISA_KEV>https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json</CISA_KEV>-->
                                </resourceLocations>
                            </cisaKevDownload>

                            <epssDownload>
                                <resourceLocations>
                                    <!-- <EPSS_ALL_SCORES_CSV>https://epss.cyentia.com/epss_scores-current.csv.gz</EPSS_ALL_SCORES_CSV> -->
                                </resourceLocations>
                            </epssDownload>

                            <eolDownload>
                                <resourceLocations>
                                    <!-- URL for the EOL API that is used to fetch the version information for a single product.
                                         - %s the product identifier to fetch the version information for (example: <code>java</code>) -->
                                    <!--<EOL_PRODUCT_VERSIONS>https://endoflife.date/api/%s.json</EOL_PRODUCT_VERSIONS>-->

                                    <!-- URL for the EOL API that is used to fetch all product identifiers. Returns an array of strings. -->
                                    <!--<EOL_ALL_PRODUCTS>https://endoflife.date/api/all.json</EOL_ALL_PRODUCTS>-->
                                </resourceLocations>
                            </eolDownload>

                            <cweDownload>
                                <resourceLocations>
                                    <!-- URL for the CWE Download is used to fetch complete and latest CWE Information -->
                                    <!--<MOST_RECENT_CWE>https://cwe.mitre.org/data/xml/cwec_latest.xml.zip</MOST_RECENT_CWE>-->

                                    <!-- This URL is optional but can be used to download the complete CWE information for a specific version -->
                                    <!--<SPECIFIC_VERSION_CWE>https://cwe.mitre.org/data/xml/cwec_v%s.xml.zip</SPECIFIC_VERSION_CWE>-->
                                </resourceLocations>
                            </cweDownload>

                            <capecDownload>
                                <resourceLocations>
                                    <!-- URL to fetch the complete and latest CAPEC Information as an CVS.zip-->
                                    <!--<MOST_RECENT_CAPEC_CSV>https://capec.mitre.org/data/archive/capec_latest.zip</MOST_RECENT_CAPEC_CSV>-->
                                    <!-- URL to fetch the complete and latest CAPEC Information as an XML.zip-->
                                    <!--<MOST_RECENT_CAPEC_XML>https://capec.mitre.org/data/xml/views/2000.xml.zip</MOST_RECENT_CAPEC_XML>-->
                                </resourceLocations>
                            </capecDownload>

                            <cveListDownload>
                                <useGitCommand>true</useGitCommand>
                                <resourceLocations>
                                    <!-- Remote repository URL of the CVEProject/cvelistV5 repository -->
                                    <!-- <GIT_URL>https://github.com/CVEProject/cvelistV5</GIT_URL>-->
                                    <!-- Remote URL of the zip download of the CVEProject/cvelistV5 repository -->
                                    <!-- <GIT_ZIP_DOWNLOAD_URL>https://github.com/CVEProject/cvelistV5/archive/refs/heads/main.zip</GIT_ZIP_DOWNLOAD_URL>-->
                                </resourceLocations>
                            </cveListDownload>

                        </configuration>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>
</project>
